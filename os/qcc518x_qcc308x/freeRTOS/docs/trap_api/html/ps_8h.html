<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>Trap API: ps.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Trap API
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('ps_8h.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">ps.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga3745e8701fe6def6453aa66679b025e7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__trapset__core.html#ga3745e8701fe6def6453aa66679b025e7">PsDefrag</a> (void)</td></tr>
<tr class="memdesc:ga3745e8701fe6def6453aa66679b025e7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Start PS store defragmentation in the background Changing a key with <a class="el" href="group__trapset__core.html#ga023228f45d2cede814c9bed9dcef5680" title="Copy the specified memory buffer to persistent store. A Persistent store user key can be deleted by c...">PsStore()</a> trap adds a new instance of the key to PS store. After some time the store becomes filled with multiple instances of the same keys that consume space. To remove the old data and recover space in the store, defragmentation needs to be performed from time to time. Defragmentation is started automatically if after a PsStore request the store is more than 90% full or can be started manually at any time using this trap or the <a class="el" href="group__trapset__core.html#ga7c21cf7e57edf43a3d540ef0f1ce1a0e" title="Defragment the PS store Changing a key with PsStore() trap adds a new instance of the key to PS store...">PsDefragBlocking()</a> trap. Unlike previous chips, defragmentation runs in the background and normally is completely transparent to the application. However it can cause some disruption to time-sensitive activities (e.g. streaming audio) depending on overall system load. It is recommended for the application to monitor PS store level with <a class="el" href="group__trapset__core.html#ga3131cc8f4279f63f535db41c4bbb9423" title="Return how many keys of this size in words we could write. ">PsFreeCount()</a> and call <a class="el" href="group__trapset__core.html#ga3745e8701fe6def6453aa66679b025e7" title="Start PS store defragmentation in the background Changing a key with PsStore() trap adds a new instan...">PsDefrag()</a> preventively when idle. For the reference with 64KB store, PsFreeCount(16) returns 142 when store is 90% full and 1055 when store is 90% empty. Defragmentation can take up to several seconds to complete depending on the store content, system load and flash chip performance. See <a class="el" href="group__trapset__core.html#ga7c21cf7e57edf43a3d540ef0f1ce1a0e" title="Defragment the PS store Changing a key with PsStore() trap adds a new instance of the key to PS store...">PsDefragBlocking()</a> for a version of this trap that returns once the defragmentation operation is complete.  <a href="group__trapset__core.html#ga3745e8701fe6def6453aa66679b025e7">More...</a><br/></td></tr>
<tr class="separator:ga3745e8701fe6def6453aa66679b025e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7c21cf7e57edf43a3d540ef0f1ce1a0e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__trapset__core.html#ga7c21cf7e57edf43a3d540ef0f1ce1a0e">PsDefragBlocking</a> (void)</td></tr>
<tr class="memdesc:ga7c21cf7e57edf43a3d540ef0f1ce1a0e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Defragment the PS store Changing a key with <a class="el" href="group__trapset__core.html#ga023228f45d2cede814c9bed9dcef5680" title="Copy the specified memory buffer to persistent store. A Persistent store user key can be deleted by c...">PsStore()</a> trap adds a new instance of the key to PS store. After some time the store becomes filled with multiple instances of the same keys that consume space. To remove the old data and recover space in the store, defragmentation needs to be performed from time to time. Defragmentation is started automatically if after a PsStore request the store is more than 90% full or can be started manually at any time using this trap or the <a class="el" href="group__trapset__core.html#ga3745e8701fe6def6453aa66679b025e7" title="Start PS store defragmentation in the background Changing a key with PsStore() trap adds a new instan...">PsDefrag()</a> trap. For the reference with 64KB store, PsFreeCount(16) returns 142 when store is 90% full and 1055 when store is 90% empty. This trap will run defragmentation in a blocking manner, i.e. upon calling this trap, control will not be returned to the application until defragmentation is complete. Defragmentation is a time and memory intensive operation, it is recommended that this trap only be called if it's acceptable for the application to be blocked for several seconds. See <a class="el" href="group__trapset__core.html#ga3745e8701fe6def6453aa66679b025e7" title="Start PS store defragmentation in the background Changing a key with PsStore() trap adds a new instan...">PsDefrag()</a> for the non-blocking version of this trap.  <a href="group__trapset__core.html#ga7c21cf7e57edf43a3d540ef0f1ce1a0e">More...</a><br/></td></tr>
<tr class="separator:ga7c21cf7e57edf43a3d540ef0f1ce1a0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4b29378f646885e1becc6723e02184c8"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__trapset__core.html#ga4b29378f646885e1becc6723e02184c8">PsDrop</a> (uint16 key)</td></tr>
<tr class="memdesc:ga4b29378f646885e1becc6723e02184c8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove the given key from the system cache. Only applicable to the PSKEY_READONLY key set, this call removes the specified key from the system cache, freeing up system memory. This also makes it unreadable until the next power-cycle, so the customer application should take care to not read the key again.  <a href="group__trapset__core.html#ga4b29378f646885e1becc6723e02184c8">More...</a><br/></td></tr>
<tr class="separator:ga4b29378f646885e1becc6723e02184c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3131cc8f4279f63f535db41c4bbb9423"><td class="memItemLeft" align="right" valign="top">uint16&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__trapset__core.html#ga3131cc8f4279f63f535db41c4bbb9423">PsFreeCount</a> (uint16 words)</td></tr>
<tr class="memdesc:ga3131cc8f4279f63f535db41c4bbb9423"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return how many keys of this size in words we could write.  <a href="group__trapset__core.html#ga3131cc8f4279f63f535db41c4bbb9423">More...</a><br/></td></tr>
<tr class="separator:ga3131cc8f4279f63f535db41c4bbb9423"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga24848f899c37a03f5ad510d66051faae"><td class="memItemLeft" align="right" valign="top">uint16&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__trapset__core.html#ga24848f899c37a03f5ad510d66051faae">PsFullRetrieve</a> (uint16 key, void *buff, uint16 words)</td></tr>
<tr class="memdesc:ga24848f899c37a03f5ad510d66051faae"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read any persistent store key from the full range of supported keys. Note this function can be used to obtain values both for Bluecore PS keys and for Apps Subsystem PS keys. Unlike <a class="el" href="group__trapset__core.html#ga023228f45d2cede814c9bed9dcef5680" title="Copy the specified memory buffer to persistent store. A Persistent store user key can be deleted by c...">PsStore()</a> and <a class="el" href="group__trapset__core.html#ga41e5381ab0482e665e9d7d4ff8760e74" title="Copy to specified memory buffer from persistent store. ">PsRetrieve()</a> it does not use a PS key index in the range [0, 519]. It can be used for three different purposes.  <a href="group__trapset__core.html#ga24848f899c37a03f5ad510d66051faae">More...</a><br/></td></tr>
<tr class="separator:ga24848f899c37a03f5ad510d66051faae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8b1a86c9c80f7e8a46966ff4f3364afa"><td class="memItemLeft" align="right" valign="top">PsStores&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__trapset__core.html#ga8b1a86c9c80f7e8a46966ff4f3364afa">PsGetStore</a> (void)</td></tr>
<tr class="memdesc:ga8b1a86c9c80f7e8a46966ff4f3364afa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the current PS store used for PS operations.  <a href="group__trapset__core.html#ga8b1a86c9c80f7e8a46966ff4f3364afa">More...</a><br/></td></tr>
<tr class="separator:ga8b1a86c9c80f7e8a46966ff4f3364afa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8859a805b5bebaa5253777fc5ae1d838"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__trapset__core.html#ga8859a805b5bebaa5253777fc5ae1d838">PsNextAudioKey</a> (uint16 value, uint32 *key)</td></tr>
<tr class="memdesc:ga8859a805b5bebaa5253777fc5ae1d838"><td class="mdescLeft">&#160;</td><td class="mdescRight">Give the next Audio key stored in the PsStore.  <a href="group__trapset__core.html#ga8859a805b5bebaa5253777fc5ae1d838">More...</a><br/></td></tr>
<tr class="separator:ga8859a805b5bebaa5253777fc5ae1d838"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga980b769d87fe77a4c25aa1e486eb0a85"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__trapset__core.html#ga980b769d87fe77a4c25aa1e486eb0a85">PsNextKey</a> (uint16 value, uint16 *key)</td></tr>
<tr class="memdesc:ga980b769d87fe77a4c25aa1e486eb0a85"><td class="mdescLeft">&#160;</td><td class="mdescRight">Give the next Apps key stored in PsStore.  <a href="group__trapset__core.html#ga980b769d87fe77a4c25aa1e486eb0a85">More...</a><br/></td></tr>
<tr class="separator:ga980b769d87fe77a4c25aa1e486eb0a85"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga975489202189811bf857457d694697e3"><td class="memItemLeft" align="right" valign="top">uint16&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__trapset__core.html#ga975489202189811bf857457d694697e3">PsReadAudioKey</a> (uint32 key, uint16 *buffer, uint16 words, uint16 offset, uint16 *key_length_addr)</td></tr>
<tr class="memdesc:ga975489202189811bf857457d694697e3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copy to specified memory buffer from audio persistent store. A Persistent store audio key can be read by the application by invoking this trap. The trap can be used to read any part of the key data using the <code>offset</code> and <code>words</code> fields. The trap can also be used to find the key length without copying any data: PsReadAudioKey(key, NULL, 0, 0, &amp;key_len);.  <a href="group__trapset__core.html#ga975489202189811bf857457d694697e3">More...</a><br/></td></tr>
<tr class="separator:ga975489202189811bf857457d694697e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga41e5381ab0482e665e9d7d4ff8760e74"><td class="memItemLeft" align="right" valign="top">uint16&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__trapset__core.html#ga41e5381ab0482e665e9d7d4ff8760e74">PsRetrieve</a> (uint16 key, void *buff, uint16 words)</td></tr>
<tr class="memdesc:ga41e5381ab0482e665e9d7d4ff8760e74"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copy to specified memory buffer from persistent store.  <a href="group__trapset__core.html#ga41e5381ab0482e665e9d7d4ff8760e74">More...</a><br/></td></tr>
<tr class="separator:ga41e5381ab0482e665e9d7d4ff8760e74"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga218eeae791e9c3b75eb200f825d3dad1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__trapset__core.html#ga218eeae791e9c3b75eb200f825d3dad1">PsSetStore</a> (PsStores store)</td></tr>
<tr class="memdesc:ga218eeae791e9c3b75eb200f825d3dad1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the PS Store that are used for subsequent PS operations.  <a href="group__trapset__core.html#ga218eeae791e9c3b75eb200f825d3dad1">More...</a><br/></td></tr>
<tr class="separator:ga218eeae791e9c3b75eb200f825d3dad1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga023228f45d2cede814c9bed9dcef5680"><td class="memItemLeft" align="right" valign="top">uint16&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__trapset__core.html#ga023228f45d2cede814c9bed9dcef5680">PsStore</a> (uint16 key, const void *buff, uint16 words)</td></tr>
<tr class="memdesc:ga023228f45d2cede814c9bed9dcef5680"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copy the specified memory buffer to persistent store. A Persistent store user key can be deleted by calling the <a class="el" href="group__trapset__core.html#ga023228f45d2cede814c9bed9dcef5680" title="Copy the specified memory buffer to persistent store. A Persistent store user key can be deleted by c...">PsStore()</a> function with <em>key</em> to be deleted and <em>words</em> argument being zero. <a class="el" href="group__trapset__core.html#ga023228f45d2cede814c9bed9dcef5680" title="Copy the specified memory buffer to persistent store. A Persistent store user key can be deleted by c...">PsStore()</a> trap can trigger defragmentation if PS store is filled to over 90%. Defragmentation runs in the background and can cause some disruption to time-sensitive activities (e.g. streaming audio) depending on overall system load. It is recommended that the application monitors the PS store level with <a class="el" href="group__trapset__core.html#ga3131cc8f4279f63f535db41c4bbb9423" title="Return how many keys of this size in words we could write. ">PsFreeCount()</a> and calls <a class="el" href="group__trapset__core.html#ga3745e8701fe6def6453aa66679b025e7" title="Start PS store defragmentation in the background Changing a key with PsStore() trap adds a new instan...">PsDefrag()</a> when idle to avoid potential disruption.  <a href="group__trapset__core.html#ga023228f45d2cede814c9bed9dcef5680">More...</a><br/></td></tr>
<tr class="separator:ga023228f45d2cede814c9bed9dcef5680"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga803dbd145cc26e0f966117973e79cf03"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__trapset__partition.html#ga803dbd145cc26e0f966117973e79cf03">PsStoreFsTab</a> (const void *buff, uint16 words, bool commit)</td></tr>
<tr class="memdesc:ga803dbd145cc26e0f966117973e79cf03"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copy the specified memory buffer into PSKEY_FSTAB within the persistent store The function operates in a similar manner to.  <a href="group__trapset__partition.html#ga803dbd145cc26e0f966117973e79cf03">More...</a><br/></td></tr>
<tr class="separator:ga803dbd145cc26e0f966117973e79cf03"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf047136770ad108db893089f9a88b510"><td class="memItemLeft" align="right" valign="top">uint16&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__trapset__core.html#gaf047136770ad108db893089f9a88b510">PsUpdateAudioKey</a> (uint32 key, const uint16 *buffer, uint16 words, uint16 offset, uint16 key_length)</td></tr>
<tr class="memdesc:gaf047136770ad108db893089f9a88b510"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copy the specified memory buffer to audio persistent store. A Persistent store audio key can be changed by the application by invoking this trap. Since audio keys can be long, this API allows writing the new value in several steps using the <code>offset</code> field. Note, that keys can't be partialy updated, the whole new value of a key must be written. Also, blocks of data can't be written out of order. The write is finalised and the new key value becomes effective once the last block of data is written.  <a href="group__trapset__core.html#gaf047136770ad108db893089f9a88b510">More...</a><br/></td></tr>
<tr class="separator:gaf047136770ad108db893089f9a88b510"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="ps_8h.html">ps.h</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.5 </li>
  </ul>
</div>
</body>
</html>
